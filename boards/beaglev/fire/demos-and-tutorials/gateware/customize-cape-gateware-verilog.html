
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Customize BeagleV-Fire Cape Gateware Using Verilog &#8212; BeagleBoard Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/collapsible-lists/css/tree_view.css?v=a885cde7" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css?v=5c84f910" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/css/custom.css?v=99f84846" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../../_static/design-tabs.js?v=36754332"></script>
    <script src="../../../../../_static/collapsible-lists/js/CollapsibleLists.compressed.js?v=73120307"></script>
    <script src="../../../../../_static/collapsible-lists/js/apply-collapsible-lists.js?v=660e4f45"></script>
    <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js?v=ffc8af2d"></script>
    <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js?v=12818e64"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'boards/beaglev/fire/demos-and-tutorials/gateware/customize-cape-gateware-verilog';</script>
    <link rel="canonical" href="docs.beagleboard.io/boards/beaglev/fire/demos-and-tutorials/gateware/customize-cape-gateware-verilog.html" />
    <link rel="icon" href="../../../../../_static/boris.svg"/>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="How to use PicoRV Softcore on BeagleV-Fire" href="deploy-and-program-picorv-softcore.html" />
    <link rel="prev" title="Gateware TCL Scripts Structure" href="gateware-tcl-scripts-structure.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
    <meta name="docbuild:last-update" content="Jun 29, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  

    <!-- Top version and announcement message -->
    <script>
        
    // Function to generate version and announcement banner HTML
    function getBannerHTML() {
        return `
            
            <aside id="bd-header-version-warning" class="d-print-none" aria-label="Version warning">
                <div class="bd-header-announcement__content ms-auto me-auto">
                    <div class="sidebar-message">
                        
                        
                        This is an <strong>unknown version</strong> of docs.
                        
                        <a class="btn text-wrap font-weight-bold ms-3 my-1 align-baseline pst-button-link-to-stable-version" href="https://docs.beagleboard.org">
                            Switch to released version
                        </a>
                    </div>
                </div>
            </aside>
            
            
        `;
    }
    
    // Get the target element where the banners will be added
    const bannerDiv = document.getElementsByClassName('pst-async-banner-revealer')[0];

    // Add version banner and announcement banner if bannerDiv is valid
    if (bannerDiv) {
        bannerDiv.innerHTML = getBannerHTML();
    }
    
    </script>

    
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../../_static/logo.svg" class="logo__image only-light" alt="BeagleBoard Documentation - Home"/>
    <img src="../../../../../_static/logo.svg" class="logo__image only-dark pst-js-only" alt="BeagleBoard Documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="ms-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../intro/index.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../index.html">
    Boards
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../projects/index.html">
    Projects
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../books/index.html">
    Books
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../accessories/index.html">
    Accessories
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://www.beagleboard.org/about">
    About
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://www.beagleboard.org/donate">
    Donate
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://gsoc.beagleboard.org/">
    GSoC
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://forum.beagleboard.org/c/faq">
    FAQ
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://openbeagle.org/" title="OpenBeagle" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-gitlab fa-lg" aria-hidden="true"></i>
            <span class="sr-only">OpenBeagle</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://docs.beagleboard.org/" title="Docs" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-book fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Docs</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://bbb.io/discord" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://forum.beagleboard.org/" title="Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Forum</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://www.beagleboard.org" title="BeagleBoard.org" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../../../_static/images/boris.svg" class="icon-link-image" alt="BeagleBoard.org"/></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  



  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../intro/index.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../index.html">
    Boards
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../projects/index.html">
    Projects
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../books/index.html">
    Books
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../accessories/index.html">
    Accessories
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.beagleboard.org/about">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.beagleboard.org/donate">
    Donate
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://gsoc.beagleboard.org/">
    GSoC
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://forum.beagleboard.org/c/faq">
    FAQ
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://openbeagle.org/" title="OpenBeagle" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-gitlab fa-lg" aria-hidden="true"></i>
            <span class="sr-only">OpenBeagle</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://docs.beagleboard.org/" title="Docs" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-book fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Docs</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://bbb.io/discord" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://forum.beagleboard.org/" title="Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Forum</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://www.beagleboard.org" title="BeagleBoard.org" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../../../_static/images/boris.svg" class="icon-link-image" alt="BeagleBoard.org"/></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../01-introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../02-quick-start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../03-design.html">Design &amp; specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../04-expansion.html">Expansion</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../05-demos.html">Demos</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="upgrade-gateware.html">Upgrade BeagleV-Fire Gateware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../flashing-board.html">Flashing gateware and Linux image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mchp-fpga-tools-installation-guide.html">Microchip FPGA Tools Installation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html">Gateware Design Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-to-find-out-whats-on-the-board.html">How to retrieve BeagleV-Fire’s gateware version</a></li>
<li class="toctree-l2"><a class="reference internal" href="gateware-full-flow.html">Gateware Full Build Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="gateware-tcl-scripts-structure.html">Gateware TCL Scripts Structure</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Customize BeagleV-Fire Cape Gateware Using Verilog</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy-and-program-picorv-softcore.html">How to use PicoRV Softcore on BeagleV-Fire</a></li>
<li class="toctree-l2"><a class="reference internal" href="running-the-bitstream-builder-on-windows.html">How to build the BeagleV-Fire Gateware on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="exploring-gateware-design-libero.html">Exploring Gateware Design with Libero</a></li>
<li class="toctree-l2"><a class="reference internal" href="gateware-design-simulation-libero.html">Simulating Gateware Design with Libero</a></li>
<li class="toctree-l2"><a class="reference internal" href="comms-cape-gateware-usage.html">Comms Cape Gateware for BeagleV-Fire</a></li>
<li class="toctree-l2"><a class="reference internal" href="axi-apb-interfaces-demo.html">Accessing APB and AXI Peripherals Through Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../building-linux-with-buildroot.html">Building Linux for BeagleV-Fire using Buildroot</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../06-support.html">Support</a></li>
</ul>
</div>
</nav></div>
        <div class="sidebar-primary-item"><div class="card mb-3">
    <div class="card-header bg-primary text-light fw-bold">
        Why are we doing this?
    </div>
    <div class="card-body">
        <p class="card-text text-dark">
            We believe in making computers open again to democratize technology and empower individuals and organizations to explore, experiment, and create without the constraints of proprietary systems.
        </p>
    </div>
</div>

<div class="card mb-3">
    <div class="card-header bg-warning text-dark fw-bold">
        What are we doing?
    </div>
    <div class="card-body">
        <p class="card-text text-dark">
            We design versatile and affordable single-board computers to provide developers, hobbyists, and educators with a platform for prototyping, experimentation, and production of embedded systems. Our comprehensive documentation, tutorials, and vibrant online community support users in their projects and foster knowledge sharing.
        </p>
    </div>
</div>

<div class="card mb-3">
    <div class="card-header bg-success text-light fw-bold">
        How are we doing it?
    </div>
    <div class="card-body">
        <p class="card-text text-dark">
            Through open-source hardware designs, diverse software support, and active community engagement, we enable users to customize, innovate, and collaborate effortlessly in embedded computing.
        </p>
    </div>
</div>

<div class="card mb-3">
    <div class="card-header bg-dark text-light fw-bold">
        Support us <i class="fa-solid fa-hand-holding-dollar"></i>
    </div>
    <div class="card-body">
        <p class="card-text text-dark">
            The BeagleBoard.org Foundation is a Michigan, USA-based 501(c)(3) non-profit corporation existing to provide education in and collaboration around the design and use of open-source software and hardware in embedded computing.
        </p>
    </div>
    <div class="card-footer d-grid gap-2">
        <a href="https://patreon.com/beagleboard" class="btn btn-danger text-light"><i class="fa-brands fa-patreon"></i> Become a Patreon</a>
        <a href="https://github.com/sponsors/beagleboard" class="btn btn-dark text-light"><i class="fa-brands fa-github"></i> Sponsor on GitHub</a>
    </div>
</div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
<script>

document.addEventListener('DOMContentLoaded', () => {
    // Add primary sidebar toggle button
    const primarySidebar = document.getElementById('pst-primary-sidebar');
    if (primarySidebar) {
        addSidebarToggleButton(
            primarySidebar,
            'primary',
            'sidebar-toggle-btn',
            '<i class="fa-solid fa-caret-left"></i>',
            '<i class="fa-solid fa-caret-right"></i>',
            'after'
        );
    }

    // Add secondary sidebar toggle button
    const secondarySidebar = document.getElementById('pst-secondary-sidebar');
    if (secondarySidebar) {
        addSidebarToggleButton(
            secondarySidebar,
            'secondary',
            'sidebar-toggle-btn',
            '<i class="fa-solid fa-caret-right"></i>',
            '<i class="fa-solid fa-caret-left"></i>',
            'before'
        );
    }

    /**
     * Adds a toggle button for a sidebar with visibility and state management.
     * @param {HTMLElement} sidebar - The sidebar element to toggle.
     * @param {string} key - A unique key for localStorage and button id.
     * @param {string} buttonClass - CSS class for the toggle button.
     * @param {string} collapseHTML - HTML for the button when the sidebar is collapsed.
     * @param {string} expandHTML - HTML for the button when the sidebar is expanded.
     * @param {string} position - Position to insert the button ('before' or 'after').
     */
    function addSidebarToggleButton(sidebar, key, buttonClass, collapseHTML, expandHTML, position) {
        const toggleButton = document.createElement('button');
        toggleButton.id = `toggle-${key}-sidebar`;
        toggleButton.innerHTML = sidebar.classList.contains('collapsed') ? expandHTML : collapseHTML;
        toggleButton.className = buttonClass;

        // Insert the toggle button
        if (position === 'before') {
            sidebar.parentNode.insertBefore(toggleButton, sidebar);
        } else if (position === 'after') {
            sidebar.parentNode.insertBefore(toggleButton, sidebar.nextSibling);
        }

        // Restore collapsed state from localStorage
        const collapsedState = localStorage.getItem(`${key}SidebarCollapsed`) === 'true';
        if (collapsedState) {
            sidebar.classList.add('collapsed');
            toggleButton.innerHTML = expandHTML;
        }

        // Handle toggle button click
        toggleButton.addEventListener('click', () => {
            sidebar.classList.toggle('collapsed');

            // Update button content and save state
            if (sidebar.classList.contains('collapsed')) {
                toggleButton.innerHTML = expandHTML;
                localStorage.setItem(`${key}SidebarCollapsed`, 'true');
            } else {
                toggleButton.innerHTML = collapseHTML;
                localStorage.setItem(`${key}SidebarCollapsed`, 'false');
            }
        });

        // Check visibility of the toggle button
        function checkToggleVisibility() {
            const existingToggleButton = document.querySelector(
                `.pst-navbar-icon.sidebar-toggle.${key}-toggle`
            );
            if (existingToggleButton && existingToggleButton.offsetParent !== null) {
                toggleButton.style.display = 'none'; // Hide custom toggle button
            } else {
                toggleButton.style.display = 'block'; // Show custom toggle button
            }
        }

        // Update button visibility if the sidebar is removed
        function updateButtonVisibility() {
            if (window.getComputedStyle(sidebar).display === 'none') {
                toggleButton.remove(); // Remove button if sidebar is hidden
            } else if (!document.querySelector(`#toggle-${key}-sidebar`)) {
                // Re-add the button if missing
                if (position === 'before') {
                    sidebar.parentNode.insertBefore(toggleButton, sidebar);
                } else if (position === 'after') {
                    sidebar.parentNode.insertBefore(toggleButton, sidebar.nextSibling);
                }
            }
        }

        // Initial visibility check
        checkToggleVisibility();
        updateButtonVisibility();

        // Monitor window resize for dynamic button visibility updates
        window.addEventListener('resize', () => {
            checkToggleVisibility();
            updateButtonVisibility();
        });
    }
});

</script>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../../../index.html" class="nav-link">Boards</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">BeagleV-Fire</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../05-demos.html" class="nav-link">Demos</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Customize BeagleV-Fire Cape Gateware Using Verilog</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="customize-beaglev-fire-cape-gateware-using-verilog">
<span id="beaglev-fire-customize-cape-gateware-verilog"></span><h1>Customize BeagleV-Fire Cape Gateware Using Verilog<a class="headerlink" href="#customize-beaglev-fire-cape-gateware-using-verilog" title="Link to this heading">#</a></h1>
<p>This document describes how to customize gateware attached to BeagleV-Fire’s cape interface using
Verilog as primary language. The methodolgy described can also be applied when using other HDL
languages.</p>
<p>It will describe:</p>
<ul class="simple">
<li><p>How to generate programming bitstreams without requiring the installation of the Libero FPGA toolchain on your development machine.</p></li>
<li><p>How to use the cape Verilog template</p></li>
<li><p>How to use the git.beagleboard.org CI infrastruture to generate programming bitstreams for your custom gateware</p></li>
</ul>
<p>Steps:</p>
<ol class="arabic simple">
<li><p>Fork BeagleV-Fire gateware repository on git.beagleboard.org</p></li>
<li><p>Create a custom gateware build option</p></li>
<li><p>Rename a copy of the cape gateware Verilog template</p></li>
<li><p>Customize the cape’s Verilog source code</p></li>
<li><p>Commit and push changes to your forked repository</p></li>
<li><p>Retrieve the forked repositories artifacts</p></li>
<li><p>Program BeagleV-Fire with your custom bitstream</p></li>
</ol>
<section id="fork-beaglev-fire-gateware-repository">
<h2>Fork BeagleV-Fire Gateware Repository<a class="headerlink" href="#fork-beaglev-fire-gateware-repository" title="Link to this heading">#</a></h2>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>All new users need to be manually approved to protect from BOT spam. You will not be able to fork the Gateware
Repository until you have been approved. A request to <a class="reference external" href="https://forum.beagleboard.org/t/requesting-access-to-gitlab-to-fork-gateware/37494">the forum</a>
may expedite the process.</p>
</div>
<p>Navigate to BeagleV-Fire’s <a class="reference external" href="https://git.beagleboard.org/beaglev-fire/gateware">gateware source code repository</a>.</p>
<p>Click on the <code class="docutils literal notranslate"><span class="pre">Forks</span></code> button on the top-right corner.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../../../../../_images/gateware-beaglev-fire-fork.png"><img alt="BeagleV-Fire gateware repo fork button" src="../../../../../_images/gateware-beaglev-fire-fork.png" style="width: 1040px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 595 </span><span class="caption-text">BeagleV-Fire gateware repo fork button</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>On the Fork Project page, select your namespace and adjust the project name to help you manage multiple
custom gateware (e.g. <code class="docutils literal notranslate"><span class="pre">my-lovely-gateware</span></code>). Click the <code class="docutils literal notranslate"><span class="pre">Fork</span> <span class="pre">project</span></code> button.</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../../../../../_images/verilog-gateware-fork.png"><img alt="Create gateware fork" src="../../../../../_images/verilog-gateware-fork.png" style="width: 1040px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 596 </span><span class="caption-text">Create gateware fork</span><a class="headerlink" href="#id3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="clone-the-forked-repository">
<h3>Clone the forked repository<a class="headerlink" href="#clone-the-forked-repository" title="Link to this heading">#</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>git@git.beagleboard.org:&lt;MY-NAMESPACE&gt;/my-lovely-gateware.git
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;MY-NAMESPACE&gt;</span></code> is your Gitlab username or namespace.</p>
</section>
</section>
<section id="create-a-custom-gateware-build-option">
<h2>Create A Custom Gateware Build Option<a class="headerlink" href="#create-a-custom-gateware-build-option" title="Link to this heading">#</a></h2>
<p>BeagleV-Fire’s gateware build system uses “build configuration” YAML files to describe the combination
of gateware components options that will be used to build the gateware programming bitstream. You need
to create one such file to describe to the gateware build system that you want your own custom gateware
to be built. You need to have one such file describing your gateware in directory <code class="docutils literal notranslate"><span class="pre">custom-fpga-design</span></code>.</p>
<p>Let’s modify the <code class="docutils literal notranslate"><span class="pre">./custom-fpga-design/my_custom_fpga_design.yaml</span></code> build configuration file to
specify that your custom cape gateware should be included in the gateware bitstream. In this instance will
call our custom cape gateware <code class="docutils literal notranslate"><span class="pre">MY_LOVELY_CAPE</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">HSS</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">git</span>
<span class="w">    </span><span class="nt">link</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/polarfire-soc/hart-software-services.git</span>
<span class="w">    </span><span class="nt">branch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">master</span>
<span class="w">    </span><span class="nt">make_clean</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">gateware</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sources</span>
<span class="w">    </span><span class="nt">build-args</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;M2_OPTION:NONE</span><span class="nv"> </span><span class="s">CAPE_OPTION:MY_LOVELY_CAPE&quot;</span><span class="w"> </span><span class="c1"># ①</span>
</pre></div>
</div>
<p>① On the gateware build-args line, replace VERILOG_TUTORIAL with MY_LOVELY_CAPE.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>custom-fpga-design</strong> directory has a special meaning for the Beagleboard Gitlab CI system.
Any build configuration found in this directory will be built by the CI system. This allows generating
FPGA programming bitstreams without the requirement for having the Microchip FPGA toolchain installed
on your computer.</p>
</div>
</section>
<section id="rename-a-copy-of-the-cape-gateware-verilog-template">
<h2>Rename A Copy Of The Cape Gateware Verilog Template<a class="headerlink" href="#rename-a-copy-of-the-cape-gateware-verilog-template" title="Link to this heading">#</a></h2>
<section id="move-to-the-cape-gateware-source-code">
<h3>Move to the cape gateware source code<a class="headerlink" href="#move-to-the-cape-gateware-source-code" title="Link to this heading">#</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>my-lovely-gateware/sources/FPGA-design/script_support/components/CAPE
</pre></div>
</div>
</section>
<section id="create-a-directory-that-will-contain-your-custom-cape-gateware-source-code">
<h3>Create a directory that will contain your custom cape gateware source code<a class="headerlink" href="#create-a-directory-that-will-contain-your-custom-cape-gateware-source-code" title="Link to this heading">#</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>MY_LOVELY_CAPE
</pre></div>
</div>
</section>
<section id="copy-the-cape-verilog-template">
<h3>Copy the cape Verilog template<a class="headerlink" href="#copy-the-cape-verilog-template" title="Link to this heading">#</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>-r<span class="w"> </span>VERILOG_TEMPLATE/*<span class="w"> </span>./MY_LOVELY_CAPE/
</pre></div>
</div>
</section>
</section>
<section id="customize-the-cape-s-verilog-source-code">
<h2>Customize The Cape’s Verilog Source Code<a class="headerlink" href="#customize-the-cape-s-verilog-source-code" title="Link to this heading">#</a></h2>
<div class="line-block">
<div class="line">You will only need to change the content of <code class="docutils literal notranslate"><span class="pre">ADD_CAPE.tcl</span></code> if you want to modify how the cape interfaces with the rest of the gateware</div>
<div class="line">(RISC-V processor subsystem, clock and reset blocks).</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="line-block">
<div class="line">Any Verilog file (*.v) you put in the <code class="docutils literal notranslate"><span class="pre">HDL</span></code> subdirectory will automatically be pulled into the project by the build system.</div>
<div class="line">Manual intervention is no longer required.</div>
</div>
</div>
<section id="id1">
<h3>Customize The Cape’s Verilog source code<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>We will add a simple Verilog source file, <code class="docutils literal notranslate"><span class="pre">blinky.v</span></code>, in the <code class="docutils literal notranslate"><span class="pre">MY_LOVELY_CAPE/HDL</span></code> directory. Code below:</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="o">/</span><span class="mh">100</span><span class="n">ps</span>

<span class="k">module</span><span class="w"> </span><span class="n">blinky</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="n">clk</span><span class="p">,</span>
<span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="n">resetn</span><span class="p">,</span>
<span class="w">  </span><span class="k">output</span><span class="w"> </span><span class="n">blink</span>
<span class="p">);</span>

<span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">22</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">counter</span><span class="p">;</span>

<span class="k">assign</span><span class="w"> </span><span class="n">blink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counter</span><span class="p">[</span><span class="mh">22</span><span class="p">];</span>

<span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">,</span><span class="w"> </span><span class="k">negedge</span><span class="w"> </span><span class="n">resetn</span><span class="p">)</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="o">~</span><span class="n">resetn</span><span class="p">)</span>
<span class="w">  </span><span class="k">begin</span>
<span class="w">    </span><span class="n">counter</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">23</span><span class="mb">&#39;b0</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">  </span><span class="k">begin</span>
<span class="w">    </span><span class="n">counter</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">23</span><span class="mb">&#39;b1</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>

<span class="k">endmodule</span>
</pre></div>
</div>
<p>Let’s connect the blinky Verilog module within the cape by editing the <code class="docutils literal notranslate"><span class="pre">CAPE.v</span></code> file (we’re still in the HDL subdirectory).</p>
<p>Add the instantiation of the blinky module:</p>
<div class="highlight-dts notranslate"><div class="highlight"><pre><span></span><span class="c1">//--------P9_41_42_IOPADS</span>
<span class="na">P9_41_42_IOPADS</span><span class="w"> </span><span class="na">P9_41_42_IOPADS_0</span><span class="p">(</span>
<span class="w">        </span><span class="c1">// Inputs</span>
<span class="w">        </span><span class="p">.</span><span class="na">GPIO_OE</span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="na">GPIO_OE_const_net_3</span><span class="w"> </span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="na">GPIO_OUT</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="na">GPIO_OUT_const_net_3</span><span class="w"> </span><span class="p">),</span>
<span class="w">        </span><span class="c1">// Outputs</span>
<span class="w">        </span><span class="p">.</span><span class="na">GPIO_IN</span><span class="w">  </span><span class="p">(</span><span class="w">  </span><span class="p">),</span>
<span class="w">        </span><span class="c1">// Inouts</span>
<span class="w">        </span><span class="p">.</span><span class="na">P9_41</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="na">P9_41</span><span class="w"> </span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="na">P9_42</span><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="na">P9_42</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="p">);</span>

<span class="c1">//--------blinky</span>
<span class="na">blinky</span><span class="w"> </span><span class="na">blinky_0</span><span class="p">(</span><span class="w">                </span><span class="c1">// ①</span>
<span class="w">        </span><span class="p">.</span><span class="na">clk</span><span class="w">     </span><span class="p">(</span><span class="w"> </span><span class="na">PCLK</span><span class="w"> </span><span class="p">),</span><span class="w">      </span><span class="c1">// ②</span>
<span class="w">        </span><span class="p">.</span><span class="na">resetn</span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="na">PRESETN</span><span class="w"> </span><span class="p">),</span><span class="w">   </span><span class="c1">// ③</span>
<span class="w">        </span><span class="p">.</span><span class="na">blink</span><span class="w">   </span><span class="p">(</span><span class="w"> </span><span class="na">BLINK</span><span class="w"> </span><span class="p">)</span><span class="w">      </span><span class="c1">// ④</span>
<span class="w">        </span><span class="p">);</span>

<span class="na">endmodule</span>
</pre></div>
</div>
<p>① Create a blinky module instance called blinky_0.</p>
<p>② Connect the clock using the existing PCLK wire.</p>
<p>③ Connect the reset using the exisitng PRESETS wire.</p>
<p>④ Connect the blinky’s blink output using the BLINK wire. This BLINK wire needs to be declared.</p>
<p>Add the BLINK wire:</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="kt">wire</span><span class="w">           </span><span class="n">PCLK</span><span class="p">;</span>
<span class="kt">wire</span><span class="w">           </span><span class="n">PRESETN</span><span class="p">;</span>
<span class="kt">wire</span><span class="w">           </span><span class="n">BLINK</span><span class="p">;</span><span class="w">                   </span><span class="c1">// ①</span>
<span class="kt">wire</span><span class="w">   </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">APB_SLAVE_PRDATA_net_0</span><span class="p">;</span>
<span class="kt">wire</span><span class="w">   </span><span class="p">[</span><span class="mh">27</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">GPIO_IN_net_1</span><span class="p">;</span>
</pre></div>
</div>
<p>① Create a wire called BLINK.</p>
<div class="line-block">
<div class="line">The BLINK wire will be used to connect the blinky module’s output to a top level output connected to a LED.</div>
<div class="line">Do you see where this is going?</div>
<div class="line"><br /></div>
<div class="line">Now for the complicated part. We are going to change the wiring of the bi-directional buffers</div>
<div class="line">controlling the cape I/Os including the user LEDs.</div>
<div class="line"><br /></div>
<div class="line">The original code populates two 43 bit-wide vectors,</div>
<div class="line">for controlling the output-enable and output values of the P8 cape connector I/Os.</div>
<div class="line"><br /></div>
<div class="line">The bottom 28 bits being controlled by the microprocessor subsystem’s GPIO block; those are the ones we want.</div>
</div>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="c1">//--------------------------------------------------------------------</span>
<span class="c1">// Concatenation assignments</span>
<span class="c1">//--------------------------------------------------------------------</span>
<span class="k">assign</span><span class="w"> </span><span class="n">GPIO_OE_net_0</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">16&#39;h0000</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_OE</span><span class="w"> </span><span class="p">};</span>
<span class="k">assign</span><span class="w"> </span><span class="n">GPIO_OUT_net_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">16&#39;h0000</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_OUT</span><span class="w"> </span><span class="p">};</span>
</pre></div>
</div>
<p>We are going to hijack the 6th I/O with our blinky’s output:</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="c1">//--------------------------------------------------------------------</span>
<span class="c1">// Concatenation assignments</span>
<span class="c1">//--------------------------------------------------------------------</span>
<span class="k">assign</span><span class="w"> </span><span class="n">GPIO_OE_net_0</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">16&#39;h0000</span><span class="p">,</span><span class="w">  </span><span class="n">GPIO_OE</span><span class="p">[</span><span class="mh">27</span><span class="o">:</span><span class="mh">6</span><span class="p">],</span><span class="w">  </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">,</span><span class="w">  </span><span class="n">GPIO_OE</span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="p">};</span><span class="w">    </span><span class="c1">// ①</span>
<span class="k">assign</span><span class="w"> </span><span class="n">GPIO_OUT_net_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">16&#39;h0000</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_OUT</span><span class="p">[</span><span class="mh">27</span><span class="o">:</span><span class="mh">6</span><span class="p">],</span><span class="w"> </span><span class="n">BLINK</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_OUT</span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="p">};</span><span class="w">    </span><span class="c1">// ②</span>
</pre></div>
</div>
<p>① Tie high the output-enable of the 6th bit to constantly enable that output.</p>
<p>② Control the 6th output from the blink module through the BLINK wire.</p>
</section>
<section id="edit-the-cape-s-device-tree-overlay">
<h3>Edit The Cape’s Device Tree Overlay<a class="headerlink" href="#edit-the-cape-s-device-tree-overlay" title="Link to this heading">#</a></h3>
<div class="line-block">
<div class="line">You should always have a device tree overlay associated with your gateware even if there is limited control from Linux.</div>
<div class="line">The device tree overlay is very useful to identify which gateware is currently programmed on your BeagleV-Fire.</div>
</div>
<div class="highlight-dts notranslate"><div class="highlight"><pre><span></span><span class="cp">/dts-v1/</span><span class="p">;</span>
<span class="cp">/plugin/</span><span class="p">;</span>

<span class="o">&amp;</span><span class="p">{</span><span class="o">/</span><span class="na">chosen</span><span class="p">}</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="na">overlays</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">MY-LOVELY-CAPE-GATEWARE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;GATEWARE_GIT_VERSION&quot;</span><span class="p">;</span><span class="w">   </span><span class="c1">// ①</span>
<span class="w">        </span><span class="p">};</span>
<span class="p">};</span>
</pre></div>
</div>
<p>① Replace VERILOG-CAPE-GATEWARE with MY-LOVELY-CAPE-GATEWARE.</p>
<div class="line-block">
<div class="line">This change will result in <code class="docutils literal notranslate"><span class="pre">MY-LOVELY-CAPE-GATEWARE</span></code> being visible in <code class="docutils literal notranslate"><span class="pre">/proc/device-tree/chosen/overlays</span></code> at run-time,</div>
<div class="line">allowing to check that my lovely gateware is successfully programmed on BeagleV-Fire.</div>
</div>
</section>
</section>
<section id="commit-and-push-changes-to-your-forked-repository">
<h2>Commit And Push Changes To Your Forked Repository<a class="headerlink" href="#commit-and-push-changes-to-your-forked-repository" title="Link to this heading">#</a></h2>
<p>Move back up to the root directory of your gateware project. This is the my-lovely-gateware directory in our current example.</p>
<p>Add the <code class="docutils literal notranslate"><span class="pre">my-lovely-gateware/sources/FPGA-design/script_support/components/CAPE/MY_LOVELY_CAPE</span></code> directory content to your git repository.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>sources/FPGA-design/script_support/components/CAPE/MY_LOVELY_CAPE/
</pre></div>
</div>
<p>Commit changes to <code class="docutils literal notranslate"><span class="pre">my-lovely-gateware/custom-fpga-design/my_custom_fpga_design.yaml</span></code></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Add my lovely gateware.&quot;</span>
</pre></div>
</div>
<p>Push changes to your beagleboard Gitlab repository:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>push
</pre></div>
</div>
</section>
<section id="retrieve-the-forked-repositories-artifacts">
<h2>Retrieve The Forked Repositories Artifacts<a class="headerlink" href="#retrieve-the-forked-repositories-artifacts" title="Link to this heading">#</a></h2>
<div class="line-block">
<div class="line">Navigate to your forked repository. Click Pipelines in the left pane then the Download Artifacts button on the right handside.</div>
<div class="line">Select <code class="docutils literal notranslate"><span class="pre">build-job:archive</span></code>. This will result in an <code class="docutils literal notranslate"><span class="pre">artifacts.zip</span></code> file being downloaded.</div>
</div>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../../../../../_images/gateware-pipeline.png"><img alt="gateware pipeline" src="../../../../../_images/gateware-pipeline.png" style="width: 1040px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 597 </span><span class="caption-text">gateware pipeline</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="program-beaglev-fire-with-your-custom-bitstream">
<h2>Program BeagleV-Fire With Your Custom Bitstream<a class="headerlink" href="#program-beaglev-fire-with-your-custom-bitstream" title="Link to this heading">#</a></h2>
<p>Unzip the downloaded <code class="docutils literal notranslate"><span class="pre">artifacts.zip</span></code> file. Go to the <code class="docutils literal notranslate"><span class="pre">gateware-builds-tester/artifacts/bitstreams</span></code> directory:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>gateware-builds-tester/artifacts/bitstreams
</pre></div>
</div>
<div class="line-block">
<div class="line">On your Linux host development computer, use the scp command to copy the bitstream to BeagleV-Fire home directory,</div>
<div class="line">replacing <code class="docutils literal notranslate"><span class="pre">&lt;IP_ADDRESS&gt;</span></code> with the IP address of your BeagleV-Fire.</div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>scp<span class="w"> </span>-r<span class="w">  </span>./my_custom_fpga_design<span class="w"> </span>beagle@&lt;IP_ADDRESS&gt;:/home/beagle/
</pre></div>
</div>
<p>On BeagleV-Fire, initiate the reprogramming of the FPGA with your gateware bitstream:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>/usr/share/beagleboard/gateware/change-gateware.sh<span class="w"> </span>./my_custom_fpga_design
</pre></div>
</div>
<p>Wait for a couple of minutes for the BeagleV-Fire to reprogram itself.</p>
<div class="line-block">
<div class="line">You will see the 6th user LED flash once the board is reprogrammed.</div>
<div class="line">That’s the Verilog you added blinking the LED.</div>
<div class="line"><br /></div>
<div class="line">On BeagleV-Fire, You can check that your gateware was loaded using the following command</div>
<div class="line">to see the device tree overlays:</div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>tree<span class="w"> </span>/proc/device-tree/chosen/overlays/
</pre></div>
</div>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../../../../../_images/gateware-lovely-overlay.png"><img alt="gateware lovely overlay" src="../../../../../_images/gateware-lovely-overlay.png" style="width: 740px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 598 </span><span class="caption-text">gateware lovely overlay</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="gateware-tcl-scripts-structure.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Gateware TCL Scripts Structure</p>
      </div>
    </a>
    <a class="right-next"
       href="deploy-and-program-picorv-softcore.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">How to use PicoRV Softcore on BeagleV-Fire</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item"><a role="button" data-bs-toggle="modal" data-bs-target="#todoModal" href="#" id="modalfortodoitems">
    <button type="button" class="btn btn-danger">Outstanding todo items</button>
</a>

<div class="modal fade" id="todoModal" aria-labelledby="todoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title m-0 text-dark" id="todoModalLabel">Outstanding todo items</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div> 
        <div class="modal-body">
            <ul class="list-group list-group-flush" id="todolist">
                <!-- Auto generated for page -->
            </ul>
        </div>
        </div>
    </div>
</div>

<script>

    document.body.appendChild(document.getElementById('todoModal'));
    var modalfortodoitems = document.getElementById('modalfortodoitems');
    var modalfortodoitemsparent = modalfortodoitems.parentNode;
    var todoItems = document.getElementsByClassName('admonition-todo');
    var todolist = document.getElementById('todolist')

    if(todoItems.length == 0 || !todoItems[0].hasAttribute('id')) {
        modalfortodoitemsparent.remove();
    } else  {
        for (var i = 0; i < todoItems.length; ++i) {
            var todoItem = document.createElement('li');
            var link = document.createElement('a');
            link.textContent = todoItems[i].getElementsByTagName('p')[1].innerHTML;
            link.href = '#' + todoItems[i].id;
            link.addEventListener('click', function() {
                // Use Bootstrap's modal method to hide the modal
                const todoModal = document.getElementById('todoModal');
                const modal = bootstrap.Modal.getInstance(todoModal);
                modal.hide();
            });
            todoItem.appendChild(link);
            todoItem.classList.add('list-group-item');
            todolist.appendChild(todoItem);
        }
    }
    
</script></div>

  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fork-beaglev-fire-gateware-repository">Fork BeagleV-Fire Gateware Repository</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clone-the-forked-repository">Clone the forked repository</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-custom-gateware-build-option">Create A Custom Gateware Build Option</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rename-a-copy-of-the-cape-gateware-verilog-template">Rename A Copy Of The Cape Gateware Verilog Template</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#move-to-the-cape-gateware-source-code">Move to the cape gateware source code</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-directory-that-will-contain-your-custom-cape-gateware-source-code">Create a directory that will contain your custom cape gateware source code</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copy-the-cape-verilog-template">Copy the cape Verilog template</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#customize-the-cape-s-verilog-source-code">Customize The Cape’s Verilog Source Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Customize The Cape’s Verilog source code</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#edit-the-cape-s-device-tree-overlay">Edit The Cape’s Device Tree Overlay</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#commit-and-push-changes-to-your-forked-repository">Commit And Push Changes To Your Forked Repository</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-the-forked-repositories-artifacts">Retrieve The Forked Repositories Artifacts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-beaglev-fire-with-your-custom-bitstream">Program BeagleV-Fire With Your Custom Bitstream</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://openbeagle.org/docs/docs.beagleboard.io/-/edit/main/boards/beaglev/fire/demos-and-tutorials/gateware/customize-cape-gateware-verilog.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on OpenBeagle
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../../../_sources/boards/beaglev/fire/demos-and-tutorials/gateware/customize-cape-gateware-verilog.rst">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
    

    

    

    

    

    

    

    
        
        <a role="button" href="/beaglev-fire.pdf" target="_blank">
            <i class="fa-solid fa-download"></i> Download PDF
        </a>
    

    

    

    

    

    

    

    
</div>

  <div class="sidebar-secondary-item"><a role="button" data-bs-toggle="modal" data-bs-target="#feedbackModal" href="#" onclick="getFeedbackButtonhref(this)">
    <i class="fa-regular fa-message"></i> Provide Feedback
</a>

<div class="modal fade" id="feedbackModal" aria-labelledby="feedbackModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title m-0 text-dark" id="feedbackModalLabel">Feedback</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                <div class="btn-group mb-3" role="group" aria-label="Basic radio toggle button group" id="feedbackType"
                    onChange="feedbackHandler()">
                    <input type="radio" class="btn-check" name="feedbackType" id="btnradio1" autocomplete="off"
                        value="Issue">
                    <label class="btn btn-outline-dark shadow-none" for="btnradio1"><i
                            class="fa-solid fa-triangle-exclamation"></i> Issue</label>

                    <input type="radio" class="btn-check" name="feedbackType" id="btnradio2" autocomplete="off"
                        value="Feedback" checked>
                    <label class="btn btn-outline-dark shadow-none" for="btnradio2"><i
                            class="fa-regular fa-message"></i> Feedback</label>

                    <input type="radio" class="btn-check" name="feedbackType" id="btnradio3" autocomplete="off"
                        value="Idea">
                    <label class="btn btn-outline-dark shadow-none" for="btnradio3"><i
                            class="fa-solid fa-lightbulb"></i> Idea</label>
                </div>
                <div class="mb-3">
                    <input type="title" class="form-control bg-light text-dark" id="feedbackModalTitle"
                        placeholder="Title" onChange="feedbackHandler()">
                </div>
                <div class="mb-3">
                    <textarea class="form-control bg-light text-dark" id="feedbackModalDescription" minlength="13"
                        rows="3" placeholder="Description" onChange="feedbackHandler()"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="feedbackClear()">Clear
                    & Close</button>
                <span id="generateLinkButtonTooltip" data-bs-placement="bottom" data-bs-toggle="tooltip">
                    <a href="javascript:void(0);" id="feedbacklink" type="button"
                        class="btn btn-primary disabled text-light">
                        <i class="fa-solid fa-up-right-from-square"></i> Generate OpenBeagle Issue
                    </a>
                </span>
            </div>
        </div>
    </div>
</div>

<script>

    var titleMinLength = 4
    var descriptionMinLength = 12

    document.body.appendChild(document.getElementById('feedbackModal'));

    var generateLinkButtonTooltip = document.getElementById("generateLinkButtonTooltip")
    var link = document.getElementById("feedbacklink")
    var gitlab_project = ""
    var title = document.getElementById("feedbackModalTitle")
    var description = document.getElementById("feedbackModalDescription")
    var generatedFromLink = ""


    title.placeholder = "Title (minimum " + titleMinLength + " characters)"
    description.placeholder = "Description (minimum " + descriptionMinLength + " characters)"

    function feedbackHandler() {
        var type = document.querySelector('input[name="feedbackType"]:checked').value

        if (!gitlab_project.match(/^[a-zA-Z]+:\/\//)) {
            gitlab_project = 'https://' + gitlab_project;
        }

        if (title.value.length >= titleMinLength && description.value.length >= descriptionMinLength) {
            link.target = "_blank"
            link.classList.remove("disabled");
            generateLinkButtonTooltip.title = "You must be logged in to OpenBeagle.org to generate an Issue!"
            link.href = gitlab_project + "/-/issues/new?issue[title]=" + type + ": " + title.value + "&issue[description]=" + description.value + "%0A%0AGenerated from: " + generatedFromLink.replace('#', '%23')
        } else {
            link.classList.add("disabled");
            generateLinkButtonTooltip.title = "Add proper title and description to activate the link!"
        }
    }

    function feedbackClear() {
        title.value = ""
        description.value = ""
        link.href = ""
        link.classList.add("disabled");
    }

    document.addEventListener('DOMContentLoaded', function () {
        const headerlinks = document.getElementsByClassName("headerlink");

        for (let i = 0; i < headerlinks.length; i++) {
            if (headerlinks[i].classList.contains('headerlink-feedback')) {
                continue;
            }

            headerlinks[i].innerHTML = `<i class="fa-solid fa-link"></i>`;
            headerlinks[i].addEventListener('click', function (event) {
                event.preventDefault();
                const link = this.href;
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(link).then(() => {
                        console.log("Link copied to clipboard:", link);
                        this.innerHTML = `<i class="fa-regular fa-square-check"></i>`;
                        setTimeout(() => {
                            this.innerHTML = `<i class="fa-solid fa-link"></i>`;
                        }, 1000);
                    }).catch(err => {
                        console.error("Failed to copy:", err);
                    });
                } else {
                    fallbackCopyText(link, this);
                }
            });

            const feedbackLink = headerlinks[i].cloneNode(true);

            feedbackLink.classList.add('headerlink-feedback');
            feedbackLink.innerHTML = '<i class="fa-regular fa-message"></i>';
            feedbackLink.title = "Provide Feedback";
            feedbackLink.setAttribute("data-bs-toggle", "modal");
            feedbackLink.setAttribute("data-bs-target", "#feedbackModal");
            feedbackLink.setAttribute("onclick", "getFeedbackButtonhref(this)");

            if (headerlinks[i].parentNode) {
                headerlinks[i].parentNode.insertBefore(feedbackLink, headerlinks[i].nextSibling || null);
            }
        }
    });

    function fallbackCopyText(text, element) {
        const textarea = document.createElement("textarea");
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        try {
            document.execCommand("copy");
            element.innerHTML = `<i class="fa-regular fa-square-check"></i>`;
            setTimeout(() => {
                element.innerHTML = `<i class="fa-solid fa-link"></i>`;
            }, 1000);
        } catch (err) {
            console.error("Fallback: Failed to copy:", err);
        }
        document.body.removeChild(textarea);
    }

    function getFeedbackButtonhref(clickedFeedbackLink) {
        generatedFromLink = clickedFeedbackLink.href
        feedbackHandler()
    }

</script></div>

  <div class="sidebar-secondary-item"><a role="button" href="https://forum.beagleboard.org" target="_blank">
    <i class="fa-brands fa-discourse"></i> Discuss on Forum
</a></div>

  <div class="sidebar-secondary-item">
    

    

    

    

    

    

    

    
        <a role="button" data-bs-toggle="modal" data-bs-target="#licenseTerms" href="#">
            <i class="fa-regular fa-rectangle-list"></i> License Terms
        </a>

        <div class="modal fade" id="licenseTerms" aria-labelledby="licenseTermsLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title m-0 text-dark" id="licenseTermsLabel">BeagleV-Fire - License Terms</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div> 
                <div class="modal-body">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></li>
                        <li class="list-group-item">Design materials and license can be found in the <a href="https://openbeagle.org/beaglev-fire/beaglev-fire">BeagleV-Fire git repository</a></li>
                        <li class="list-group-item">Use of the boards or design materials constitutes an agreement to the <a href="/boards/terms-and-conditions.html">Terms & Conditions</a></li>
                        <li class="list-group-item">Software images and purchase links available on the <a href="https://www.beagleboard.org/boards/beaglev-fire">BeagleV-Fire board page</a></li>
                        <li class="list-group-item">For export, emissions and other compliance, see <a href="/boards/beaglev/fire/06-support.html">Support Information</a></li>
                        <li class="list-group-item">All support for this design is through BeagleBoard.org community at <a href="https://forum.beagleboard.org/tag/fire">BeagleBoard.org forum.</a></li>
                    </ul>
                </div>
                </div>
            </div>
        </div>

        <script>
            document.body.appendChild(document.getElementById('licenseTerms'));
        </script>
    

    

    

    
</div>

  <div class="sidebar-secondary-item"><div class="card bg-light mt-4 text-center">
    <div class="card-body">
        <p class="card-text text-dark">
        <a href="https://www.beagleboard.org/" target="_blank">BeagleBoard.org</a> 
        is all about being open, please discuss in public on our 
        <a href="https://forum.beagleboard.org" target="_blank">forum</a>!</p>
    </div>
</div></div>

  <div class="sidebar-secondary-item">

















<div class="card bg-light mt-4 text-center">
    <div class="card-header">
        BeagleV Fire
    </div>
    <div class="card-body">
        <p class="card-text text-dark">
            <a href="https://certification.oshwa.org/us002572.html" target="_blank">
                
                <img src="../../../../_static/images/oshw/BeagleV Fire_US002572.svg" alt="BeagleV Fire OSHW mark" />
                
            </a>
        </p>
    </div>
</div>





</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        


      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, BeagleBoard.org Foundation.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item"><a href="https://creativecommons.org/licenses/by-sa/4.0/" style="text-decoration:none">
    <img src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-sa.svg"/>
</a></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="last-updated">
  Last updated on Jun 29, 2025.
  <br/>
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>